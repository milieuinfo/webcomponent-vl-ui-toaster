{"version":3,"file":"toaster.js","sources":["../../src/js/toaster.js"],"sourcesContent":["/**\n * Toaster\n */\n\n/**\n * Private Variables\n */\nconst toasterClass = `${vl.ns}toaster`,\n  toasterFadeClass = `${toasterClass}--fade`,\n  alertClass = `${vl.ns}alert`,\n  alertCloseClass = `${alertClass}__close`,\n  dataPrefix = `data-${vl.ns}`,\n  toasterAtt = `${dataPrefix}toaster`,\n  toasterDressedAtt = `${toasterAtt}-dressed`,\n  toasterFadeoutAtt = `${toasterAtt}-fadeout`;\n\n/**\n * Private Functions\n */\nconst _addAlert = (alert) => {\n  vl.util.addClass(alert, toasterFadeClass);\n  window.setTimeout(() => {\n    vl.util.removeClass(alert, toasterFadeClass);\n  }, 300);\n};\n\nconst _removeAlert = (alert) => {\n  vl.util.addClass(alert, toasterFadeClass);\n  window.setTimeout(() => {\n    alert.remove();\n  }, 300);\n};\n\nconst _bindCloseButtons = (actions) => {\n  vl.util.each(actions, action => {\n    action.addEventListener('click', e => {\n      _removeAlert(e.currentTarget.parentElement);\n    });\n  });\n};\n\nconst _observeToaster = (event) => {\n  let toaster = event[0].target,\n    firstAlert = toaster.firstElementChild,\n    newAlert = toaster.lastElementChild;\n\n  // detect if alert is added\n  if(event[0].addedNodes.length > 0) {\n    _addAlert(newAlert);\n    _bindCloseButtons(newAlert.querySelectorAll(`.${alertCloseClass}`));\n    if(toaster.getAttribute(toasterFadeoutAtt) === 'true') {\n      window.setTimeout(() => {\n        _removeAlert(newAlert);\n      }, 5000);\n    }\n  }\n\n  // when five or more alerts are visible\n  if(toaster.childElementCount > 5) {\n    _removeAlert(firstAlert);\n  }\n};\n\nclass Toaster {\n  dress(toaster) {\n    toaster.setAttribute(toasterDressedAtt, true);\n\n    let observer = new window.MutationObserver(_observeToaster),\n      actions = toaster.querySelectorAll(`.${alertCloseClass}`);\n\n    observer.observe(toaster, {attributes: true, childList: true});\n\n    _bindCloseButtons(actions);\n  }\n\n  dressAll() {\n    let elements = document.querySelectorAll(\n      `.${toasterClass}:not([${toasterDressedAtt}]):not([data-${vl.ns}js-dress=\"false\"]),\n      [${toasterAtt}]:not([${toasterDressedAtt}]):not([data-${vl.ns}js-dress=\"false\"])`\n    );\n\n    vl.util.each(elements, element => {\n      this.dress(element);\n    });\n  }\n}\n\nif (!('toaster' in vl)) {\n  vl.toaster = new Toaster();\n  vl.toaster.dressAll();\n}\n\nexport default Toaster;\n"],"names":["toasterClass","vl","ns","toasterFadeClass","alertClass","alertCloseClass","dataPrefix","toasterAtt","toasterDressedAtt","toasterFadeoutAtt","_addAlert","alert","util","addClass","window","setTimeout","removeClass","_removeAlert","remove","_bindCloseButtons","actions","each","action","addEventListener","e","currentTarget","parentElement","_observeToaster","event","toaster","target","firstAlert","firstElementChild","newAlert","lastElementChild","addedNodes","length","querySelectorAll","getAttribute","childElementCount","Toaster","setAttribute","observer","MutationObserver","observe","attributes","childList","elements","document","element","dress","dressAll"],"mappings":"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"}